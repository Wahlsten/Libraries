classdef uq_obj
    % Uncertainty quantification object
    properties
        Distribution;
        GridData;
        GridGeom;
        method;
        basisF;
        IPfact;
        MaxPol;
        statistics;
        analytical;
        PC;
    end
    methods
        function obj      = createGrid(obj)
            
            if strcmp(obj.method, 'NI')
                
                % Data
                if obj.GridData.N(1) == 0
                    s = 0;                    
                else
                    s = linspace(obj.Distribution.minv(1), obj.Distribution.maxv(1), obj.GridData.N(1)+1);
                end
                
                if obj.GridData.dim == 0
                    obj.GridData.grid = 0;
                    obj.GridData.d(1) = 0;
                elseif obj.GridData.dim == 1
                    obj.GridData.grid = s;
                    obj.GridData.d(1) = (obj.Distribution.maxv(1)-obj.Distribution.minv(1))/(obj.GridData.N(1));
                elseif obj.GridData.dim == 2
                    s2 = linspace(obj.Distribution.minv(2), obj.Distribution.maxv(2), obj.GridData.N(2) + 1);
                    [obj.GridData.grid(:,:,1), obj.GridData.grid(:,:,2)] = meshgrid(s, s2);
                end
                
                % Geometry
                if obj.GridGeom.N(1) == 0
                    s = 0;
                else
                    s = linspace(obj.Distribution.minv(1), obj.Distribution.maxv(1), obj.GridGeom.N(1)+1);
                end
                
                if obj.GridGeom.dim == 0
                    obj.GridGeom.grid = 0;
                    obj.GridGeom.d(1) = 0;
                elseif obj.GridGeom.dim == 1
                    obj.GridGeom.grid = s;
                    obj.GridGeom.d(1) = (obj.Distribution.maxv(1)-obj.Distribution.minv(1))/(obj.GridGeom.N(1));
                elseif obj.Distribution.dim == 2
                    s2 = linspace(obj.Distribution.minv(2), obj.Distribution.maxv(2), obj.GridGeom.N(2) + 1);
                    [obj.GridGeom.grid(:,:,1), obj.GridGeom.grid(:,:,2)] = meshgrid(s, s2);
                end
                
            elseif strcmp(obj.method, 'PC')
                
                obj.MaxPol = max(10, obj.GridData.N);
                w = NodesWeights2(obj, obj.Distribution.name, obj.MaxPol + 1);
                                
                if strcmp(obj.Distribution.name, 'Uniform')
                    
                    obj.basisF    = cell(1, obj.MaxPol + 1);
                    obj.basisF{1} = @(s) s.^0;
                    obj.basisF{2} = @(s) sqrt(3) * s;
                    
                    for k = 3:obj.GridData.N(1) + 1
                        
                        obj.basisF{k} = @(s) (sqrt(2 * k - 3) / (k - 1) * s .* obj.basisF{k - 1}(s) ...
                            - (k - 2) / ((k - 1) * sqrt(2 * k - 5)) * obj.basisF{k - 2}(s)) * sqrt(2 * k - 1);
                    end
                    
                    factor = 1/2;
                    
                elseif strcmp(obj.Distribution.name, 'Normal')
                    obj.basisF = cell(1, obj.MaxPol + 1);
                    obj.basisF{1} = @(s) s.^0;
                    obj.basisF{2} = @(s) s;
                    for k = 3:obj.GridGeom.N(1) + 1
                        obj.basisF{k} = @(s) 1/sqrt(k - 1) * s .* obj.basisF{k - 1}(s) ...
                            - sqrt((k - 2) / (k - 1)) * obj.basisF{k - 2}(s);
                    end
                    
                    factor = 1/sqrt(pi);
                    
                end
                
                for m = 0:obj.GridData.N(1)
                    
                    for l = 1:obj.MaxPol + 1
                        
                        obj.IPfact(m + 1, l) = obj.basisF{m + 1}(w(l,2)) * w(l,1) * factor;
                    end
                end
                obj.GridData.grid = 0:obj.GridData.N(1);
                
                % Geometry
                if obj.GridGeom.N(1) == 0
                    s = 0;
                else
                    s = linspace(obj.Distribution.minv(1), obj.Distribution.maxv(1), obj.GridGeom.N(1)+1);
                end
                
                if obj.GridGeom.dim == 0
                    obj.GridGeom.grid = 0;
                    obj.GridGeom.d(1) = 0;
                elseif obj.GridGeom.dim == 1
                    obj.GridGeom.grid = s;
                    obj.GridGeom.d(1) = (obj.Distribution.maxv(1)-obj.Distribution.minv(1))/(obj.GridGeom.N(1));
                elseif obj.Distribution.dim == 2
                    s2 = linspace(obj.Distribution.minv(2), obj.Distribution.maxv(2), obj.GridGeom.N(2) + 1);
                    [obj.GridGeom.grid(:,:,1), obj.GridGeom.grid(:,:,2)] = meshgrid(s, s2);
                end
            end
        end
        function moment   = computeMoment(obj, u_ns, m)
            
            moment = zeros(size(u_ns(:,:,1)));
            
            if strcmp(obj.method, 'NI')
                
                if strcmp(obj.Distribution.name, 'Normal')
                    
                    pdf = normpdf(obj.Grid.grid, obj.Distribution.parameters(1), obj.Distribution.parameters(2));
                    % pdf = pdf / sum(pdf);
                    
                elseif strcmp(obj.Distribution.name, 'Uniform')
                    
                    pdf = ones(obj.GridData.N(1) + 1, 1) * 1/2; %ones(obj.N(1) + 1, 1) * 1 / (obj.N(1) + 1);
                    
                end
                
                momentgrid = zeros(size(u_ns(:,:,1), 1), size(u_ns(:,:,1), 2), obj.GridData.N(1) + 1);
                
                for k = 1:obj.GridData.N(1) + 1
                    
                    momentgrid(:, :, k) = u_ns(:,:,k).^m * pdf(k);
                    
                end
                
                % moment = trapz(momentgrid, 3) * obj.Grid.d(1);
                % I = h/3*(f(1)+2*sum(f(3:2:end-2))+4*sum(f(2:2:end))+f(end));
                moment = (momentgrid(:, :, 1) + 2 * sum(momentgrid(:, :, 3:2:end - 2), 3) + 4 * sum(momentgrid(:, :, 2:2:end), 3) + momentgrid(:, :, end)) * obj.GridData.d(1) / 3;
                
            elseif strcmp(obj.method, 'PC')
                
                if m == 1
                    
                    moment = u_ns(:,:,1);
                    
                else
                    
                    for k = 1:size(u_ns, 3)
                        
                        moment = moment + u_ns(:,:,k).^m;
                        
                    end
                end
            end
        end
        function variance = computeVariance(obj, u_ns)
            
            moment1 = computeMoment(obj, u_ns, 1);
            moment2 = computeMoment(obj, u_ns, 2);
            variance = moment2 - moment1.^2;
            
        end
        function obj      = computeStatistics(obj, u_ns)
            
            obj.statistics.mean     = computeMoment(obj, u_ns, 1);
            obj.statistics.variance = computeVariance(obj, u_ns);
            
        end
        function [mean_cmp_normed_t, variance_cmp_normed_t, obj] = functionals(obj, grid_obj, u_ns)
            
            
            if strcmp(obj.method, 'PC')
                
                error = cell(size(obj.analytical));
                
                for k = 1:size(error, 2)
                    
                    if k <= size(u_ns, 2)
                        error{k} = abs(obj.analytical{k} - u_ns{k});
                    else
                        error{k} = abs(obj.analytical{k});
                    end
                end
                
            elseif strcmp(obj.method, 'NI')
                
                if strcmp(obj.Distribution.name, 'Uniform')
                    
                    obj.basisF = cell(size(obj.analytical));
                    obj.basisF{1} = @(s) s.^0;
                    obj.basisF{2} = @(s) sqrt(3) * s;
                    
                    for k = 3:size(obj.analytical, 2)

                        obj.basisF{k} = @(s) (sqrt(2 * k - 3) / (k - 1) * s .* obj.basisF{k - 1}(s) ...
                            - (k - 2) / ((k - 1) * sqrt(2 * k - 5)) * obj.basisF{k - 2}(s)) * sqrt(2 * k - 1);
                        
                    end
                    
                elseif strcmp(obj.Distribution.name, 'Normal')
                    
                    obj.basisF = cell(size(obj.analytical));
                    obj.basisF{1} = @(s) s.^0;
                    obj.basisF{2} = @(s) s;
                    
                    for k = 3:size(obj.analytical, 2)
                        obj.basisF{k} = @(s) 1/sqrt(k - 1) * s .* obj.basisF{k - 1}(s) ...
                            - sqrt((k - 2) / (k - 1)) * obj.basisF{k - 2}(s);
                    end
                end
            end
            
            obj.statistics.mean     = computeMoment(obj, u_ns, 1);
            obj.statistics.variance = computeVariance(obj, u_ns);
            
            mean_analytical     = obj.statistics.mean_a;
            variance_analytical = obj.statistics.variance_a;
            
            mean_cmp_normed       = sum(abs(mean_analytical - obj.statistics.mean), 1)         .* grid_obj.d(1);
            variance_cmp_normed   = sum(abs(variance_analytical - obj.statistics.variance), 1) .* grid_obj.d(1);
            
            mean_cmp_normed_t     = sum(mean_cmp_normed)     * grid_obj.d(end);
            variance_cmp_normed_t = sum(variance_cmp_normed) * grid_obj.d(end);
            
        end
        function obj      = computeAnalyticalStatistics(obj, problem_obj)
            
            if strcmp(obj.Distribution.name, 'Normal')
                
                obj.statistics.mean_a     = @(x, t) (integral(@(s)  problem_obj.u_a(x, t, s) ...
                    .* normpdf(s, obj.Distribution.parameters(1), obj.Distribution.parameters(2)), -10, 10, 'ArrayValued', 1));
                obj.statistics.moment2_a  = @(x, t) (integral(@(s) (problem_obj.u_a(x, t, s)).^2 ...
                    .* normpdf(s, obj.Distribution.parameters(1), obj.Distribution.parameters(2)), -10, 10, 'ArrayValued', 1));
                
            elseif strcmp(obj.Distribution.name, 'Uniform')
                
                obj.statistics.mean_a     = @(x, t) (integral(@(s) problem_obj.u_a(x, t, s)    * 1/2, -1, 1, 'ArrayValued', 1));
                obj.statistics.moment2_a  = @(x, t) (integral(@(s) problem_obj.u_a(x, t, s).^2 * 1/2, -1, 1, 'ArrayValued', 1));
                
            end
            
            obj.statistics.variance_a = @(x, t) (obj.statistics.moment2_a(x, t) - obj.statistics.mean_a(x, t).^2);
            
        end
        function A        = A_L(~, n)
           
            if n == 0
                
                A = 1;
                
            elseif n < 0
                
                A = 0;
                
            elseif n >= 1
                
                A = 1;
                
                for j = 1:n
                    
                    A = A * (2 * j - 1);
                    
                end
                
                A = A / factorial(n);
                
            end
        end
        function C        = TripleProduct(obj, f)
            
            M = obj.GridData.N(1);
            C = zeros(M + 1, M + 1, M + 1);

            for i = 0:M
                                
                for j = 0:M
                    
                    for k = 0:M
                        
                        s = (i + j + k) / 2;
                        
                        if rem(i + j + k, 2) == 1 || abs(i - j) > k || k > i + j || max([i,j,k]) > s
                            
                            C(i + 1, j + 1, k + 1) = 0;
                            
                        else
                            
                            C(i + 1, j + 1, k + 1) = sqrt((2 * i + 1) ...
                                * (2 * j + 1) * (2 * k + 1)) / (i + j + k + 1) ...
                                * obj.A_L(s - i) * obj.A_L(s - j) * obj.A_L(s - k) / obj.A_L(s);
                            
%                             C(i + 1, j + 1, k + 1) = ...
%                                 factorial(i) * factorial(j) * factorial(k) / ...
%                                 ((factorial(s - i) * factorial(s - j) * factorial(s - k)) * ...
%                                 sqrt(factorial(i)) * sqrt(factorial(j)) * sqrt(factorial(k)));
                            
                        end
                    end
                end
            end
            
            C = f * C;
            
        end
        function C = TripleHermite(obj, f)
            
            M = obj.GridData.N(1);
            C = zeros(M + 1, M + 1, M + 1);

            for i = 0:M
                                
                for j = 0:M
                    
                    for k = 0:M
                        
                        s = (i + j + k) / 2;
                        
                        if rem(i + j + k, 2) == 1 || i > s || j > s || k > s
                            
                            C(i + 1, j + 1, k + 1) = 0;
                            
                        else
                            
                            C(i + 1, j + 1, k + 1) = ...
                                factorial(i) * factorial(j) * factorial(k) / ...
                                ((factorial(s - i) * factorial(s - j) * factorial(s - k)) * ...
                                sqrt(factorial(i)) * sqrt(factorial(j)) * sqrt(factorial(k)));
                            
                        end
                    end
                end
            end
            
            C = f * C;
            
        end
        function C        = DoubleProduct(obj)
            C = zeros(length(obj.GridData.grid));
            C(:,:) = diag(factorial(obj.GridData.grid) .* kroneckerDelta(obj.GridData.grid,sym(obj.GridData.grid)));
        end
        function w        = NodesWeights2(~, polynomial, M)
            
            if strcmp(polynomial, 'Uniform')
                
                if M == 1
                    
                    w = [2 0];
                    
                elseif M == 2
                    
                    w = [1.0000000000000000    -0.5773502691896257;
                        1.0000000000000000     0.5773502691896257];
                    
                elseif M == 3
                    w = [0.8888888888888888     0.0000000000000000;
                        0.5555555555555556    -0.7745966692414834;
                        0.5555555555555556     0.7745966692414834];
                elseif M == 4
                    w = [0.6521451548625461    -0.3399810435848563;
                        0.6521451548625461     0.3399810435848563;
                        0.3478548451374538    -0.8611363115940526;
                        0.3478548451374538     0.8611363115940526];
                elseif M == 5
                    w = [0.5688888888888889     0.0000000000000000;
                        0.4786286704993665    -0.5384693101056831;
                        0.4786286704993665     0.5384693101056831;
                        0.2369268850561891    -0.9061798459386640;
                        0.2369268850561891     0.9061798459386640];
                elseif M == 6
                    w = [0.3607615730481386     0.6612093864662645;
                        0.3607615730481386    -0.6612093864662645;
                        0.4679139345726910    -0.2386191860831969;
                        0.4679139345726910     0.2386191860831969;
                        0.1713244923791704    -0.9324695142031521;
                        0.1713244923791704     0.9324695142031521];
                    
                elseif M == 7
                    w = [0.4179591836734694     0.0000000000000000;
                        0.3818300505051189     0.4058451513773972;
                        0.3818300505051189    -0.4058451513773972;
                        0.2797053914892766    -0.7415311855993945;
                        0.2797053914892766     0.7415311855993945;
                        0.1294849661688697    -0.9491079123427585;
                        0.1294849661688697     0.9491079123427585];
                    
                elseif M == 8
                    w = [0.3626837833783620    -0.1834346424956498;
                        0.3626837833783620     0.1834346424956498;
                        0.3137066458778873    -0.5255324099163290;
                        0.3137066458778873     0.5255324099163290;
                        0.2223810344533745    -0.7966664774136267;
                        0.2223810344533745     0.7966664774136267;
                        0.1012285362903763    -0.9602898564975363;
                        0.1012285362903763     0.9602898564975363];
                elseif M == 9
                    w = [0.3302393550012598     0.0000000000000000;
                        0.1806481606948574    -0.8360311073266358;
                        0.1806481606948574     0.8360311073266358;
                        0.0812743883615744    -0.9681602395076261;
                        0.0812743883615744     0.9681602395076261;
                        0.3123470770400029    -0.3242534234038089;
                        0.3123470770400029     0.3242534234038089;
                        0.2606106964029354    -0.6133714327005904;
                        0.2606106964029354     0.6133714327005904];
                elseif M == 10
                    w = [0.2955242247147529     -0.1488743389816312;
                        0.2955242247147529     0.1488743389816312;
                        0.2692667193099963    -0.4333953941292472;
                        0.2692667193099963     0.4333953941292472;
                        0.2190863625159820    -0.6794095682990244;
                        0.2190863625159820     0.6794095682990244;
                        0.1494513491505806    -0.8650633666889845;
                        0.1494513491505806     0.8650633666889845;
                        0.0666713443086881    -0.9739065285171717;
                        0.0666713443086881     0.9739065285171717];
                elseif M == 11
                    
                    w = [0.0556685671161736664828    -0.9782286581460569928039;
                        0.125580369464904624635 	-0.8870625997680952990752;
                        0.1862902109277342514261	-0.7301520055740493240934;
                        0.233193764591990479919 	-0.5190961292068118159257;
                        0.262804544510246662181 	-0.2695431559523449723315;
                        0.2729250867779006307145 	 0;
                        0.262804544510246662181 	 0.2695431559523449723315;
                        0.233193764591990479919      0.5190961292068118159257;
                        0.1862902109277342514261  	 0.7301520055740493240934;
                        0.125580369464904624635  	 0.8870625997680952990752;
                        0.0556685671161736664828 	 0.9782286581460569928039];
                    
                elseif M == 12
                    w = [0.0471753363865118271946    -0.9815606342467192506905;
                        0.1069393259953184309603    -0.9041172563704748566785;
                        0.1600783285433462263347    -0.7699026741943046870369;
                        0.2031674267230659217491    -0.5873179542866174472967;
                        0.233492536538354808761     -0.3678314989981801937527;
                        0.2491470458134027850006    -0.1252334085114689154724;
                        0.2491470458134027850006    0.1252334085114689154724;
                        0.233492536538354808761     0.3678314989981801937527;
                        0.2031674267230659217491    0.5873179542866174472967;
                        0.1600783285433462263347    0.7699026741943046870369;
                        0.1069393259953184309603    0.9041172563704748566785;
                        0.0471753363865118271946    0.9815606342467192506905];
                elseif M == 13
                    w = [0.04048400476531587952     -0.9841830547185881494728;
                        0.0921214998377284479144	-0.9175983992229779652065;
                        0.1388735102197872384636	-0.8015780907333099127942;
                        0.17814598076194573828      -0.642349339440340220644;
                        0.207816047536888502313     -0.4484927510364468528779;
                        0.2262831802628972384121	-0.2304583159551347940655;
                        0.2325515532308739101946	0;
                        0.2262831802628972384121	0.2304583159551347940655;
                        0.207816047536888502313     0.4484927510364468528779;
                        0.17814598076194573828      0.642349339440340220644;
                        0.1388735102197872384636	0.8015780907333099127942;
                        0.0921214998377284479144	0.9175983992229779652065;
                        0.04048400476531587952      0.9841830547185881494728];
                elseif M == 14
                    w = [0.0351194603317518630318	-0.9862838086968123388416;
                        0.0801580871597602098056	-0.9284348836635735173364;
                        0.121518570687903184689     -0.8272013150697649931898;
                        0.1572031671581935345696	-0.687292904811685470148;
                        0.1855383974779378137417	-0.5152486363581540919653;
                        0.2051984637212956039659	-0.3191123689278897604357;
                        0.215263853463157790196     -0.1080549487073436620662;
                        0.215263853463157790196     0.1080549487073436620662;
                        0.2051984637212956039659	0.3191123689278897604357;
                        0.1855383974779378137417	0.5152486363581540919653;
                        0.1572031671581935345696	0.687292904811685470148;
                        0.121518570687903184689     0.8272013150697649931898;
                        0.0801580871597602098056	0.9284348836635735173364;
                        0.0351194603317518630318	0.9862838086968123388416];
                elseif M == 15
                    w = [0.0307532419961172683546	-0.9879925180204854284896;
                        0.0703660474881081247093	-0.9372733924007059043078;
                        0.1071592204671719350119	-0.8482065834104272162006;
                        0.1395706779261543144478	-0.7244177313601700474162;
                        0.166269205816993933553     -0.5709721726085388475372;
                        0.186161000015562211027     -0.3941513470775633698972;
                        0.1984314853271115764561	-0.2011940939974345223006;
                        0.2025782419255612728806	0;
                        0.1984314853271115764561	0.2011940939974345223006;
                        0.186161000015562211027     0.3941513470775633698972;
                        0.166269205816993933553     0.5709721726085388475372;
                        0.1395706779261543144478	0.7244177313601700474162;
                        0.1071592204671719350119	0.8482065834104272162006;
                        0.0703660474881081247093	0.9372733924007059043078;
                        0.0307532419961172683546    0.9879925180204854284896];
                elseif M == 16
                    w = [0.0271524594117540948518	-0.9894009349916499325962;
                        0.06225352393864789286284	-0.944575023073232576078;
                        0.0951585116824927848099	-0.8656312023878317438805;
                        0.1246289712555338720525	-0.7554044083550030338951;
                        0.149595988816576732082     -0.6178762444026437484467;
                        0.169156519395002538189     -0.4580167776572273863424;
                        0.1826034150449235888668	-0.2816035507792589132305;
                        0.1894506104550684962854	-0.0950125098376374401853;
                        0.1894506104550684962854	0.0950125098376374401853;
                        0.1826034150449235888668	0.2816035507792589132305;
                        0.169156519395002538189     0.4580167776572273863424;
                        0.149595988816576732082     0.6178762444026437484467;
                        0.1246289712555338720525	0.7554044083550030338951;
                        0.0951585116824927848099	0.8656312023878317438805;
                        0.06225352393864789286284	0.944575023073232576078;
                        0.0271524594117540948518	0.9894009349916499325962];
                    
                elseif M == 17
                    w = [0.0241483028685479319601	-0.9905754753144173356754;
                        0.0554595293739872011294	-0.9506755217687677612227;
                        0.0850361483171791808835	-0.880239153726985902123;
                        0.1118838471934039710948	-0.7815140038968014069252;
                        0.135136368468525473286     -0.6576711592166907658503;
                        0.154045761076810288081     -0.5126905370864769678862;
                        0.16800410215645004451      -0.3512317634538763152972;
                        0.1765627053669926463253	-0.1784841814958478558507;
                        0.1794464703562065254583	0;
                        0.1765627053669926463253	0.1784841814958478558507;
                        0.16800410215645004451      0.3512317634538763152972;
                        0.154045761076810288081     0.5126905370864769678862;
                        0.135136368468525473286     0.6576711592166907658503;
                        0.1118838471934039710948	0.7815140038968014069252;
                        0.0850361483171791808835	0.880239153726985902123;
                        0.0554595293739872011294	0.9506755217687677612227;
                        0.0241483028685479319601	0.9905754753144173356754];
                    
                elseif M == 18
                    w = [0.0216160135264833103133	-0.99156516842093094673;
                        0.0497145488949697964533	-0.9558239495713977551812;
                        0.0764257302548890565291	-0.8926024664975557392061;
                        0.1009420441062871655628	-0.8037049589725231156824;
                        0.1225552067114784601845	-0.6916870430603532078749;
                        0.140642914670650651205     -0.5597708310739475346079;
                        0.154684675126265244925     -0.4117511614628426460359;
                        0.1642764837458327229861	-0.251886225691505509589;
                        0.169142382963143591841     -0.08477501304173530124226;
                        0.169142382963143591841     0.08477501304173530124226;
                        0.1642764837458327229861	0.251886225691505509589;
                        0.154684675126265244925     0.4117511614628426460359;
                        0.140642914670650651205     0.5597708310739475346079;
                        0.1225552067114784601845	0.6916870430603532078749;
                        0.1009420441062871655628	0.8037049589725231156824;
                        0.0764257302548890565291	0.8926024664975557392061;
                        0.0497145488949697964533	0.9558239495713977551812;
                        0.0216160135264833103133	0.99156516842093094673];
                    
                elseif M == 19
                    w = [0.0194617882297264770363	-0.992406843843584403189;
                        0.044814226765699600333     -0.9602081521348300308528;
                        0.0690445427376412265807	-0.9031559036148179016427;
                        0.0914900216224499994645	-0.8227146565371428249789;
                        0.111566645547333994716     -0.7209661773352293786171;
                        0.128753962539336227676     -0.6005453046616810234696;
                        0.142606702173606611776     -0.4645707413759609457173;
                        0.1527660420658596667789	-0.3165640999636298319901;
                        0.15896884339395434765      -0.1603586456402253758681;
                        0.1610544498487836959792	0;
                        0.15896884339395434765      0.1603586456402253758681;
                        0.1527660420658596667789	0.3165640999636298319901;
                        0.142606702173606611776     0.4645707413759609457173;
                        0.128753962539336227676     0.6005453046616810234696;
                        0.111566645547333994716     0.7209661773352293786171;
                        0.0914900216224499994645	0.8227146565371428249789;
                        0.0690445427376412265807	0.9031559036148179016427;
                        0.044814226765699600333     0.9602081521348300308528;
                        0.0194617882297264770363	0.992406843843584403189];
                    
                elseif M == 20
                    
                    w = [0.017614007139152118312	-0.9931285991850949247861;
                        0.040601429800386941331     -0.9639719272779137912677;
                        0.06267204833410906357      -0.9122344282513259058678;
                        0.0832767415767047487248	-0.8391169718222188233945;
                        0.1019301198172404350368	-0.7463319064601507926143;
                        0.1181945319615184173124	-0.6360536807265150254528;
                        0.131688638449176626898     -0.5108670019508270980044;
                        0.1420961093183820513293	-0.3737060887154195606725;
                        0.149172986472603746788     -0.2277858511416450780805;
                        0.1527533871307258506981	-0.0765265211334973337546;
                        0.1527533871307258506981	0.0765265211334973337546;
                        0.149172986472603746788     0.2277858511416450780805;
                        0.1420961093183820513293	0.3737060887154195606725;
                        0.131688638449176626898     0.5108670019508270980044;
                        0.1181945319615184173124	0.6360536807265150254528;
                        0.1019301198172404350368	0.7463319064601507926143;
                        0.0832767415767047487248	0.8391169718222188233945;
                        0.06267204833410906357      0.9122344282513259058678;
                        0.040601429800386941331     0.9639719272779137912677;
                        0.017614007139152118312     0.9931285991850949247861];
                    
                elseif M == 21
                    
                    w = [0.0160172282577743333242	-0.9937521706203895002602;
                        0.03695378977085249379995	-0.9672268385663062943166;
                        0.0571344254268572082836	-0.9200993341504008287902;
                        0.0761001136283793020171	-0.8533633645833172836473;
                        0.0934444234560338615533	-0.7684399634756779086159;
                        0.1087972991671483776635	-0.667138804197412319306;
                        0.121831416053728534195	    -0.551618835887219807059;
                        0.1322689386333374617811	-0.4243421202074387835737;
                        0.1398873947910731547221	-0.2880213168024010966008;
                        0.144524403989970059064	    -0.145561854160895090937;
                        0.146081133649690427192	    0;
                        0.144524403989970059064	    0.145561854160895090937;
                        0.1398873947910731547221	0.2880213168024010966008;
                        0.1322689386333374617811	0.4243421202074387835737;
                        0.121831416053728534195	    0.551618835887219807059;
                        0.1087972991671483776635	0.667138804197412319306;
                        0.0934444234560338615533	0.7684399634756779086159;
                        0.0761001136283793020171	0.8533633645833172836473;
                        0.0571344254268572082836	0.9200993341504008287902;
                        0.03695378977085249379995	0.9672268385663062943166;
                        0.0160172282577743333242	0.9937521706203895002602];
                    
                elseif M == 22
                    
                    w = [0.014627995298272200685	-0.994294585482399292073;
                        0.033774901584814154793     -0.970060497835428727124;
                        0.0522933351526832859403	-0.9269567721871740005207;
                        0.069796468424520488095     -0.8658125777203001365364;
                        0.0859416062170677274144	-0.7878168059792081620043;
                        0.1004141444428809649321	-0.6944872631866827800507;
                        0.1129322960805392183934	-0.5876404035069115929589;
                        0.123252376810512424286     -0.4693558379867570264063;
                        0.131173504787062370733     -0.3419358208920842251581;
                        0.1365414983460151713526	-0.2078604266882212854788;
                        0.1392518728556319933754	-0.0697392733197222212138;
                        0.1392518728556319933754	0.0697392733197222212138;
                        0.1365414983460151713526	0.2078604266882212854788;
                        0.131173504787062370733     0.3419358208920842251581;
                        0.123252376810512424286     0.4693558379867570264063;
                        0.1129322960805392183934	0.5876404035069115929589;
                        0.1004141444428809649321	0.6944872631866827800507;
                        0.0859416062170677274144	0.7878168059792081620043;
                        0.069796468424520488095     0.8658125777203001365364;
                        0.0522933351526832859403	0.9269567721871740005207;
                        0.033774901584814154793     0.970060497835428727124;
                        0.014627995298272200685     0.994294585482399292073];
                elseif M == 23
                    
                    w = [0.013411859487141772081	-0.9947693349975521235239;
                        0.0309880058569794443107	-0.972542471218115231956;
                        0.0480376717310846685716	-0.9329710868260161023492;
                        0.06423242140852585212717	-0.8767523582704416673782;
                        0.0792814117767189549229	-0.8048884016188398921511;
                        0.092915766060035147477     -0.7186613631319501944616;
                        0.1048920914645414100741	-0.6196098757636461563851;
                        0.114996640222411364942     -0.5095014778460075496898;
                        0.1230490843067295304676	-0.3903010380302908314215;
                        0.1289057221880821499786	-0.2641356809703449305339;
                        0.1324620394046966173716	-0.1332568242984661109317;
                        0.1336545721861061753515	0;
                        0.1324620394046966173716	0.1332568242984661109317;
                        0.1289057221880821499786	0.2641356809703449305339;
                        0.1230490843067295304676	0.3903010380302908314215;
                        0.114996640222411364942     0.5095014778460075496898;
                        0.1048920914645414100741	0.6196098757636461563851;
                        0.092915766060035147477     0.7186613631319501944616;
                        0.0792814117767189549229	0.8048884016188398921511;
                        0.06423242140852585212717	0.8767523582704416673782;
                        0.0480376717310846685716	0.9329710868260161023492;
                        0.0309880058569794443107	0.972542471218115231956;
                        0.013411859487141772081     0.9947693349975521235239];
                elseif M == 24
                    
                    w = [0.0123412297999871995468	-0.99518721999702136018;
                        0.0285313886289336631813	-0.9747285559713094981984;
                        0.0442774388174198061686	-0.9382745520027327585236;
                        0.05929858491543678074637	-0.8864155270044010342132;
                        0.073346481411080305734     -0.8200019859739029219539;
                        0.0861901615319532759172	-0.7401241915785543642438;
                        0.0976186521041138882699	-0.6480936519369755692525;
                        0.107444270115965634783     -0.5454214713888395356584;
                        0.1155056680537256013533	-0.4337935076260451384871;
                        0.1216704729278033912045	-0.3150426796961633743868;
                        0.1258374563468282961214	-0.1911188674736163091586;
                        0.127938195346752156974     -0.064056892862605626085;
                        0.127938195346752156974     0.064056892862605626085;
                        0.1258374563468282961214	0.1911188674736163091586;
                        0.1216704729278033912045	0.3150426796961633743868;
                        0.1155056680537256013533	0.4337935076260451384871;
                        0.107444270115965634783     0.5454214713888395356584;
                        0.0976186521041138882699	0.6480936519369755692525;
                        0.0861901615319532759172	0.7401241915785543642438;
                        0.073346481411080305734     0.8200019859739029219539;
                        0.05929858491543678074637	0.8864155270044010342132;
                        0.0442774388174198061686	0.9382745520027327585236;
                        0.0285313886289336631813	0.9747285559713094981984];
                elseif M == 25
                    
                    w = [0.0113937985010262879479	-0.9955569697904980979088;
                        0.0263549866150321372619	-0.9766639214595175114983;
                        0.0409391567013063126556	-0.942974571228974339414;
                        0.0549046959758351919259	-0.894991997878275368851;
                        0.0680383338123569172072	-0.833442628760834001421;
                        0.0801407003350010180132	-0.7592592630373576305773;
                        0.0910282619829636498115	-0.6735663684734683644851;
                        0.1005359490670506442022	-0.5776629302412229677237;
                        0.1085196244742636531161	-0.4730027314457149605222;
                        0.1148582591457116483393	-0.3611723058093878377358;
                        0.1194557635357847722282	-0.2438668837209884320452;
                        0.122242442990310041689     -0.1228646926107103963874;
                        0.1231760537267154512039	0;
                        0.122242442990310041689     0.1228646926107103963874;
                        0.1194557635357847722282	0.2438668837209884320452;
                        0.1148582591457116483393	0.3611723058093878377358;
                        0.1085196244742636531161	0.4730027314457149605222;
                        0.1005359490670506442022	0.5776629302412229677237;
                        0.0910282619829636498115	0.6735663684734683644851;
                        0.0801407003350010180132	0.7592592630373576305773;
                        0.0680383338123569172072	0.833442628760834001421;
                        0.0549046959758351919259	0.894991997878275368851;
                        0.0409391567013063126556	0.942974571228974339414;
                        0.0263549866150321372619	0.9766639214595175114983;
                        0.0113937985010262879479	0.9955569697904980979088];
                    
                elseif M == 26
                    
                    w = [0.0105513726173430071557	-0.9958857011456169290032;
                        0.0244178510926319087896	-0.9783854459564709911006;
                        0.0379623832943627639503	-0.9471590666617142501359;
                        0.0509758252971478119983	-0.9026378619843070742177;
                        0.0632740463295748355395	-0.8454459427884980187975;
                        0.0746841497656597458871	-0.776385948820678856193;
                        0.0850458943134852392104	-0.6964272604199572648638;
                        0.094213800355914148464     -0.606692293017618063232;
                        0.1020591610944254232384	-0.5084407148245057176957;
                        0.108471840528576590657     -0.4030517551234863064811;
                        0.1133618165463196665494	-0.2920048394859568951428;
                        0.1166604434852965820447	-0.1768588203568901839691;
                        0.1183214152792622765164	-0.0592300934293132070937;
                        0.1183214152792622765164	0.0592300934293132070937;
                        0.1166604434852965820447	0.1768588203568901839691;
                        0.1133618165463196665494	0.2920048394859568951428;
                        0.108471840528576590657     0.4030517551234863064811;
                        0.1020591610944254232384	0.5084407148245057176957;
                        0.094213800355914148464     0.606692293017618063232;
                        0.0850458943134852392104	0.6964272604199572648638;
                        0.0746841497656597458871	0.776385948820678856193;
                        0.0632740463295748355395	0.8454459427884980187975;
                        0.0509758252971478119983	0.9026378619843070742177;
                        0.0379623832943627639503	0.9471590666617142501359;
                        0.0244178510926319087896	0.9783854459564709911006;
                        0.0105513726173430071557	0.9958857011456169290032];
                elseif M == 27
                    
                    w = [0.0097989960512943602612	-0.9961792628889885669389;
                        0.022686231596180623196     -0.9799234759615012228559;
                        0.035297053757419711023     -0.9509005578147050068519;
                        0.0474494125206150627041	-0.9094823206774911043006;
                        0.0589835368598335991103	-0.8562079080182944903027;
                        0.069748823766245592984     -0.7917716390705082271444;
                        0.0796048677730577712631	-0.7170134737394236992948;
                        0.088423158543756950194     -0.6329079719464951409277;
                        0.0960887273700285075657	-0.5405515645794568949003;
                        0.1025016378177457986712	-0.441148251750026880586;
                        0.1075782857885331872122	-0.3359939036385088997303;
                        0.1112524883568451926722	-0.2264593654395368588572;
                        0.11347634610896514862      -0.1139725856095299669329;
                        0.114220867378956989045     0;
                        0.11347634610896514862      0.1139725856095299669329;
                        0.1112524883568451926722	0.2264593654395368588572;
                        0.1075782857885331872122	0.3359939036385088997303;
                        0.1025016378177457986712	0.441148251750026880586;
                        0.0960887273700285075657	0.5405515645794568949003;
                        0.088423158543756950194     0.6329079719464951409277;
                        0.0796048677730577712631	0.7170134737394236992948;
                        0.069748823766245592984     0.7917716390705082271444;
                        0.0589835368598335991103	0.8562079080182944903027;
                        0.0474494125206150627041	0.9094823206774911043006;
                        0.035297053757419711023     0.9509005578147050068519;
                        0.022686231596180623196     0.9799234759615012228559;
                        0.0097989960512943602612	0.9961792628889885669389];
                elseif M == 28
                    
                    w = [0.0091242825930945177388	-0.9964424975739544499504;
                        0.0211321125927712597515	-0.9813031653708727536946;
                        0.0329014277823043799776	-0.9542592806289381972541;
                        0.04427293475900422784      -0.9156330263921320738697;
                        0.055107345675716745431     -0.8658925225743950489423;
                        0.0652729239669995957934	-0.8056413709171791714479;
                        0.074646214234568779024     -0.7356108780136317720281;
                        0.08311341722890121839      -0.6566510940388649612199;
                        0.090571744393032840942     -0.569720471811401719308;
                        0.09693065799792991585      -0.4758742249551182610344;
                        0.102112967578060769814     -0.3762515160890787102214;
                        0.1060557659228464179104	-0.2720616276351780776768;
                        0.1087111922582941352536	-0.1645692821333807712815;
                        0.110047013016475196282     -0.05507928988403427042652;
                        0.110047013016475196282     0.05507928988403427042652;
                        0.1087111922582941352536	0.1645692821333807712815;
                        0.1060557659228464179104	0.2720616276351780776768;
                        0.102112967578060769814     0.3762515160890787102214;
                        0.09693065799792991585      0.4758742249551182610344;
                        0.090571744393032840942     0.569720471811401719308;
                        0.08311341722890121839      0.6566510940388649612199;
                        0.074646214234568779024     0.7356108780136317720281;
                        0.0652729239669995957934	0.8056413709171791714479;
                        0.055107345675716745431     0.8658925225743950489423;
                        0.04427293475900422784      0.9156330263921320738697;
                        0.0329014277823043799776	0.9542592806289381972541;
                        0.0211321125927712597515	0.9813031653708727536946;
                        0.0091242825930945177388	0.9964424975739544499504];
                elseif M == 29
                    
                    w = [0.0085169038787464096543	-0.9966794422605965861632;
                        0.01973208505612270598386	-0.9825455052614131748709;
                        0.0307404922020936226444	-0.9572855957780877257982;
                        0.0414020625186828361048	-0.9211802329530587850938;
                        0.0515948269024979239126	-0.8746378049201027904178;
                        0.0612030906570791385421	-0.8181854876152524449896;
                        0.07011793325505127857      -0.7524628517344771339126;
                        0.0782383271357637838281	-0.6782145376026865151562;
                        0.0854722573661725275453	-0.5962817971382278203796;
                        0.091737757139258763348     -0.5075929551242276421026;
                        0.0969638340944086063019	-0.4131528881740086638907;
                        0.1010912737599149661218	-0.3140316378676399349482;
                        0.1040733100777293739133	-0.2113522861660010745064;
                        0.1058761550973209414066	-0.106278230132679230171;
                        0.1064793817183142442465	0;
                        0.1058761550973209414066	0.106278230132679230171;
                        0.1040733100777293739133	0.2113522861660010745064;
                        0.1010912737599149661218	0.3140316378676399349482;
                        0.0969638340944086063019	0.4131528881740086638907;
                        0.091737757139258763348     0.5075929551242276421026;
                        0.0854722573661725275453	0.5962817971382278203796;
                        0.0782383271357637838281	0.6782145376026865151562;
                        0.07011793325505127857      0.7524628517344771339126;
                        0.0612030906570791385421	0.8181854876152524449896;
                        0.0515948269024979239126	0.8746378049201027904178;
                        0.0414020625186828361048	0.9211802329530587850938;
                        0.0307404922020936226444	0.9572855957780877257982;
                        0.01973208505612270598386	0.9825455052614131748709;
                        0.0085169038787464096543    0.9966794422605965861632];
                elseif M == 30
                    
                    w = [0.0079681924961666056155	-0.9968934840746495402716;
                        0.0184664683110909591423	-0.98366812327974720997;
                        0.0287847078833233693497	-0.9600218649683075122169;
                        0.0387991925696270495968	-0.9262000474292743258793;
                        0.0484026728305940529029	-0.8825605357920526815431;
                        0.0574931562176190664817	-0.8295657623827683974429;
                        0.0659742298821804951281	-0.767777432104826194918;
                        0.073755974737705206268     -0.6978504947933157969323;
                        0.080755895229420215355     -0.6205261829892428611405;
                        0.08689978720108297980239	-0.5366241481420198992642;
                        0.0921225222377861287176	-0.4470337695380891767806;
                        0.096368737174644259639     -0.352704725530878113471;
                        0.0995934205867952670628	-0.2546369261678898464398;
                        0.1017623897484055045964	-0.1538699136085835469638;
                        0.1028526528935588403413	-0.051471842555317695833;
                        0.1028526528935588403413	0.051471842555317695833;
                        0.1017623897484055045964	0.1538699136085835469638;
                        0.0995934205867952670628	0.2546369261678898464398;
                        0.096368737174644259639     0.352704725530878113471;
                        0.0921225222377861287176	0.4470337695380891767806;
                        0.08689978720108297980239	0.5366241481420198992642;
                        0.080755895229420215355     0.6205261829892428611405;
                        0.073755974737705206268     0.6978504947933157969323;
                        0.0659742298821804951281	0.767777432104826194918;
                        0.0574931562176190664817	0.8295657623827683974429;
                        0.0484026728305940529029	0.8825605357920526815431;
                        0.0387991925696270495968	0.9262000474292743258793;
                        0.0287847078833233693497	0.9600218649683075122169;
                        0.0184664683110909591423	0.98366812327974720997;
                        0.0079681924961666056155	0.9968934840746495402716];
                end
                
                
                
            elseif strcmp(polynomial, 'Normal')
                
                if M == 1
                    w = [1.772453850906    0];
                    
                elseif M == 2
                    w = [0.88622692545     .707106781187;
                        0.88622692545    -.707106781187];
                elseif M == 3
                    w = [1.18163590060     0.00000000000;
                        0.29540897515    -1.22474487139;
                        0.29540897515     1.22474487139];
                elseif M == 4
                    w = [0.804914090006    0.524647623275;
                        0.804914090006   -0.524647623275;
                        0.081312835443    1.650680123886;
                        0.081312835443   -1.650680123886];
                elseif M == 5
                    w = [0.945308720483    0.000000000000;
                        0.393619323152    0.958572464614;
                        0.393619323152   -0.958572464614;
                        0.019953242059    2.020182870456;
                        0.019953242059   -2.020182870456];
                elseif M == 6
                    w = [0.724629595       0.436077412;
                        0.724629595      -0.436077412;
                        0.157067320       1.335849074;
                        0.157067320      -1.335849074;
                        0.004530009       2.350604974;
                        0.004530009      -2.350604974];
                    
                elseif M == 7
                    w = [0.810264618       0.000000000;
                        0.425607253       0.816287883;
                        0.425607253      -0.816287883;
                        0.054515582       1.673551629;
                        0.054515582      -1.673551629;
                        0.000971781       2.651961357;
                        0.000971781      -2.651961357];
                    
                elseif M == 8
                    w = [0.661147013       0.381186990;
                        0.661147013      -0.381186990;
                        0.207802326       1.157193712;
                        0.207802326      -1.157193712;
                        0.017077983       1.981656757;
                        0.017077983      -1.981656757;
                        0.000199604       2.930637420;
                        0.000199604      -2.930637420];
                elseif M == 9
                    w = [0.720235216       0.000000000;
                        0.432651559       0.723551019;
                        0.432651559      -0.723551019;
                        0.088474527       1.468553289;
                        0.088474527      -1.468553289;
                        0.004943624       2.266580585;
                        0.004943624      -2.266580585;
                        0.000039606       3.190993202;
                        0.000039606      -3.190993202];
                elseif M == 10
                    w = [0.610862634       0.342901327;
                        0.610862634      -0.342901327;
                        0.240138611       1.036610830;
                        0.240138611      -1.036610830;
                        0.033874394       1.756683649;
                        0.033874394      -1.756683649;
                        0.001343645       2.532731674;
                        0.001343645      -2.532731674;
                        0.000007640       3.436159119;
                        0.000007640      -3.436159119];
                elseif M == 11
                    w = [1.43956039371425822033e-6 -3.668470846559582518458;
                        3.468194663233455106434e-4 -2.783290099781651770837;
                        0.0119113954449115324504   -2.025948015825755335166;
                        0.1172278751677085033818   -1.32655708449493285595;
                        0.4293597523561250284461   -0.6568095668820997650246;
                        0.6547592869145917792039    0;
                        0.4293597523561250284461    0.6568095668820997650246;
                        0.1172278751677085033818    1.32655708449493285595;
                        0.0119113954449115324504    2.025948015825755335166;
                        3.468194663233455106434e-4  2.783290099781651770837;
                        1.43956039371425822033e-6   3.668470846559582518458];
                elseif M == 12
                    w = [2.65855168435630160602e-7  -3.889724897869781919272;
                        8.573687043587858654569e-5  -3.020637025120889771711;
                        0.003905390584629061859994  -2.279507080501059900188;
                        0.0516079856158839299919    -1.59768263515260479671;
                        0.2604923102641611292334    -0.9477883912401637437046;
                        0.5701352362624795783471    -0.3142403762543591112766;
                        0.5701352362624795783471     0.3142403762543591112766;
                        0.2604923102641611292334     0.9477883912401637437046;
                        0.0516079856158839299919     1.59768263515260479671;
                        0.003905390584629061859994   2.279507080501059900188;
                        8.573687043587858654569e-5   3.020637025120889771711;
                        2.65855168435630160602e-7    3.889724897869781919272];
                    
                elseif M == 13
                    w = [4.82573185007313108835e-8	-4.101337596178639641179
                        2.043036040270707312487e-5	-3.246608978372409988122
                        0.001207459992719385947309	-2.51973568567823788343
                        0.0208627752961699392166	-1.853107651601512142004
                        0.1403233206870234377628	-1.220055036590748426222
                        0.4216162968985432217469	-0.6057638791710601130805
                        0.604393187921161642342     0
                        0.421616296898543221747     0.605763879171060113081
                        0.1403233206870234377628	1.220055036590748426222
                        0.0208627752961699392166	1.853107651601512142004
                        0.001207459992719385947309	2.51973568567823788343
                        2.04303604027070731249e-5	3.246608978372409988122
                        4.82573185007313108835e-8	4.101337596178639641179];
                    
                elseif M == 14
                    w = [8.62859116812515794532e-9	-4.30444857047363181262
                        4.71648435501891674888e-6	-3.462656933602270550209
                        3.55092613551923610484e-4	-2.748470724985402568625
                        0.0078500547264579443105	-2.095183258507716815735
                        0.0685055342234652055387	-1.476682731141140870584
                        0.2731056090642466033526	-0.8787137873293994161147
                        0.536405909712090149795     -0.2917455106725620784461
                        0.536405909712090149795     0.2917455106725620784461
                        0.2731056090642466033526	0.8787137873293994161147
                        0.0685055342234652055387	1.476682731141140870584
                        0.00785005472645794431049	2.095183258507716815735
                        3.55092613551923610484e-4	2.748470724985402568625
                        4.71648435501891674888e-6	3.462656933602270550209
                        8.62859116812515794532e-9	4.304448570473631812621];
                    
                elseif M == 15
                    w = [1.52247580425351702016e-9	-4.49999070730939155366
                        1.05911554771106663578e-6	-3.669950373404452534729
                        1.00004441232499868127e-4	-2.967166927905603248489
                        0.00277806884291277589608	-2.325732486173857745454
                        0.03078003387254608222868	-1.719992575186488932416
                        0.1584889157959357468838	-1.136115585210920666319
                        0.4120286874988986270259	-0.565069583255575748526
                        0.564100308726417532853     0
                        0.412028687498898627026     0.565069583255575748526
                        0.1584889157959357468838	1.136115585210920666319
                        0.0307800338725460822287	1.719992575186488932416
                        0.00277806884291277589608	2.325732486173857745454
                        1.000044412324998681273e-4	2.967166927905603248489
                        1.05911554771106663578e-6	3.669950373404452534729
                        1.52247580425351702016e-9	4.49999070730939155366];
                    
                elseif M == 16
                    w = [2.6548074740111822447e-10	-4.688738939305818364688
                        2.32098084486521065339e-7	-3.86944790486012269872
                        2.71186009253788151202e-5	-3.176999161979956026814
                        9.3228400862418052991e-4	-2.546202157847481362159
                        0.01288031153550997368346	-1.951787990916253977435
                        0.0838100413989858294154	-1.380258539198880796372
                        0.2806474585285336753695	-0.8229514491446558925825
                        0.5079294790166137419135	-0.2734810461381524521583
                        0.5079294790166137419135	0.2734810461381524521583
                        0.2806474585285336753695	0.822951449144655892582
                        0.0838100413989858294154	1.380258539198880796372
                        0.0128803115355099736835	1.951787990916253977435
                        9.3228400862418052991e-4	2.546202157847481362159
                        2.71186009253788151202e-5	3.176999161979956026814
                        2.32098084486521065339e-7	3.86944790486012269872
                        2.6548074740111822447e-10	4.688738939305818364688];
                    
                elseif M == 17
                    w = [4.58057893079863330581e-11	-4.871345193674403088349
                        4.9770789816307940523e-8	-4.061946675875474306892
                        7.11228914002130958353e-6	-3.378932091141494083383
                        2.98643286697753041151e-4	-2.757762915703888730926
                        0.0050673499576275379117	-2.173502826666620819275
                        0.0409200341497562798095	-1.612924314221231333113
                        0.172648297670097079218     -1.06764872574345055363
                        0.4018264694704119565776	-0.5316330013426547313491
                        0.530917937624863560332     0
                        0.401826469470411956578     0.531633001342654731349
                        0.1726482976700970792176	1.06764872574345055363
                        0.0409200341497562798095	1.612924314221231333113
                        0.0050673499576275379117	2.173502826666620819275
                        2.98643286697753041151e-4	2.757762915703888730926
                        7.1122891400213095835e-6	3.378932091141494083383
                        4.97707898163079405228e-8	4.061946675875474306892
                        4.58057893079863330581e-11	4.871345193674403088349];
                    
                elseif M == 18
                    w = [7.8281997721158910293e-12	-5.048364008874466768372
                        1.04672057957920824444e-8	-4.248117873568126463023
                        1.8106544810934304096e-6	-3.573769068486266079501
                        9.1811268679294035291e-5	-2.961377505531606844779
                        0.00188852263026841789438	-2.386299089166686000265
                        0.0186400423875446519219	-1.835531604261628892254
                        0.0973017476413154293309	-1.300920858389617365666
                        0.2848072856699795785956	-0.7766829192674116613167
                        0.483495694725455552876     -0.258267750519096759258
                        0.483495694725455552876     0.2582677505190967592581
                        0.2848072856699795785956	0.776682919267411661317
                        0.09730174764131542933085	1.300920858389617365666
                        0.0186400423875446519219	1.835531604261628892254
                        0.00188852263026841789438	2.386299089166686000265
                        9.1811268679294035291e-5	2.961377505531606844779
                        1.8106544810934304096e-6	3.573769068486266079501
                        1.04672057957920824444e-8	4.248117873568126463023
                        7.8281997721158910293e-12	5.048364008874466768372];
                    
                elseif M == 19
                    w = [1.32629709449851575185e-12	-5.22027169053748216461
                        2.1630510098635547502e-9	-4.428532806603779437235
                        4.4882431472231229518e-7	-3.762187351964020097515
                        2.72091977631616257712e-5	-3.157848818347602281843
                        6.70877521407181106195e-4	-2.591133789794542564921
                        0.0079888667777229902092	-2.049231709850619375751
                        0.050810386909052067357     -1.524170619393533031834
                        0.1836327013069970741561	-1.010368387134311351369
                        0.391608988613030244504     -0.503520163423888209374
                        0.5029748882761865308407	0
                        0.391608988613030244504     0.5035201634238882093738
                        0.183632701306997074156     1.010368387134311351369
                        0.050810386909052067357     1.524170619393533031834
                        0.00798886677772299020922	2.049231709850619375751
                        6.708775214071811061947e-4	2.591133789794542564921
                        2.72091977631616257712e-5	3.157848818347602281843
                        4.4882431472231229518e-7	3.762187351964020097515
                        2.1630510098635547502e-9	4.428532806603779437235
                        1.326297094498515751853e-12	5.22027169053748216461];
                    
                elseif M == 20
                    w = [2.22939364553415129252e-13	-5.387480890011232862017
                        4.39934099227318055363e-10	-4.603682449550744273078
                        1.086069370769281694e-7     -3.94476404011562521038
                        7.8025564785320636941e-6	-3.34785456738321632691
                        2.283386360163539672571e-4	-2.788806058428130480525
                        0.00324377334223786183218	-2.25497400208927552308
                        0.0248105208874636108822	-1.738537712116586206781
                        0.109017206020023320014     -1.234076215395323007886
                        0.2866755053628341297197	-0.737473728545394358706
                        0.46224366960061008965      -0.245340708300901249904
                        0.4622436696006100896503	0.2453407083009012499038
                        0.2866755053628341297197	0.737473728545394358706
                        0.109017206020023320014     1.234076215395323007886
                        0.0248105208874636108822	1.738537712116586206781
                        0.00324377334223786183218	2.254974002089275523082
                        2.28338636016353967257e-4	2.78880605842813048053
                        7.8025564785320636941e-6	3.34785456738321632691
                        1.086069370769281694e-7     3.944764040115625210376
                        4.39934099227318055363e-10	4.60368244955074427308
                        2.2293936455341512925e-13	5.387480890011232862017];
                end
                
                w(:,2) = sqrt(2) * w(:,2);
                
            end
        end
    end
end